CREATE TABLE genre(
   id_genre VARCHAR(50) ,
   nom VARCHAR(50)  NOT NULL,
   PRIMARY KEY(id_genre)
);

CREATE TABLE type_materiel(
   id_type_materiel VARCHAR(50) ,
   nom VARCHAR(250)  NOT NULL,
   PRIMARY KEY(id_type_materiel)
);

CREATE TABLE unite(
   id_unite VARCHAR(50) ,
   nom VARCHAR(250)  NOT NULL,
   PRIMARY KEY(id_unite)
);

CREATE TABLE type_bordereau(
   id_type_bordereau VARCHAR(50) ,
   nom VARCHAR(250)  NOT NULL,
   PRIMARY KEY(id_type_bordereau)
);

CREATE TABLE serie_travaux(
   id_serie_travaux VARCHAR(50) ,
   nom VARCHAR(250)  NOT NULL,
   id_type_bordereau VARCHAR(50)  NOT NULL,
   PRIMARY KEY(id_serie_travaux),
   FOREIGN KEY(id_type_bordereau) REFERENCES type_bordereau(id_type_bordereau)
);

CREATE TABLE bdq(
   id_bdq VARCHAR(50) ,
   titre VARCHAR(250)  NOT NULL,
   id_type_bordereau VARCHAR(50)  NOT NULL,
   PRIMARY KEY(id_bdq),
   FOREIGN KEY(id_type_bordereau) REFERENCES type_bordereau(id_type_bordereau)
);

CREATE TABLE detail_bdq(
   id_detail_dbq VARCHAR(50) ,
   designation TEXT NOT NULL,
   quantite NUMERIC(15,2)   NOT NULL,
   id_serie_travaux VARCHAR(50)  NOT NULL,
   id_bdq VARCHAR(50)  NOT NULL,
   id_unite VARCHAR(50)  NOT NULL,
   PRIMARY KEY(id_detail_dbq),
   FOREIGN KEY(id_serie_travaux) REFERENCES serie_travaux(id_serie_travaux),
   FOREIGN KEY(id_bdq) REFERENCES bdq(id_bdq),
   FOREIGN KEY(id_unite) REFERENCES unite(id_unite)
);

CREATE TABLE detail_bde(
   id_detail_bde VARCHAR(50) ,
   prix_unitaire NUMERIC(15,2)   NOT NULL,
   id_detail_dbq VARCHAR(50)  NOT NULL,
   PRIMARY KEY(id_detail_bde),
   FOREIGN KEY(id_detail_dbq) REFERENCES detail_bdq(id_detail_dbq)
);

CREATE TABLE profil(
   id_profil VARCHAR(50) ,
   nom VARCHAR(250)  NOT NULL,
   prenom VARCHAR(250)  NOT NULL,
   date_naissance TIMESTAMP NOT NULL,
   adresse VARCHAR(250)  NOT NULL,
   id_genre VARCHAR(50)  NOT NULL,
   PRIMARY KEY(id_profil),
   FOREIGN KEY(id_genre) REFERENCES genre(id_genre)
);

CREATE TABLE utilisateur(
   id_utilisateur VARCHAR(50) ,
   email VARCHAR(250)  NOT NULL,
   mdp VARCHAR(250)  NOT NULL,
   id_profil VARCHAR(50)  NOT NULL,
   PRIMARY KEY(id_utilisateur),
   FOREIGN KEY(id_profil) REFERENCES profil(id_profil)
);

CREATE TABLE materiaux(
   id_materiaux VARCHAR(50) ,
   nom VARCHAR(250)  NOT NULL,
   prix_unitaire NUMERIC(15,2)   NOT NULL,
   id_bdq VARCHAR(50)  NOT NULL,
   id_unite VARCHAR(50)  NOT NULL,
   id_type_materiel VARCHAR(50)  NOT NULL,
   PRIMARY KEY(id_materiaux),
   FOREIGN KEY(id_bdq) REFERENCES bdq(id_bdq),
   FOREIGN KEY(id_unite) REFERENCES unite(id_unite),
   FOREIGN KEY(id_type_materiel) REFERENCES type_materiel(id_type_materiel)
);

CREATE TABLE detail_materiaux(
   id_materiaux VARCHAR(50) ,
   id_detail_dbq VARCHAR(50) ,
   quantite NUMERIC(15,2)   NOT NULL,
   PRIMARY KEY(id_materiaux, id_detail_dbq),
   FOREIGN KEY(id_materiaux) REFERENCES materiaux(id_materiaux),
   FOREIGN KEY(id_detail_dbq) REFERENCES detail_bdq(id_detail_dbq)
);
